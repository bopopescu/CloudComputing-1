

Q1


SELECT CLIENT.*, PROPERTYFORRENT.RENT
FROM PROPERTYFORRENT
    JOIN VIEWING
        ON PROPERTYFORRENT.PROPERTYNO = VIEWING.PROPERTYNO
    JOIN STAFF
        ON STAFF.STAFFNO = PROPERTYFORRENT.STAFFNO
    JOIN CLIENT
        ON CLIENT.CLIENTNO = VIEWING.CLIENTNO
    
    
WHERE STAFF.FNAME = 'Mary' AND STAFF.LNAME = 'Howe' AND VIEWING.VIEWDATE > '30-APR-13';





Q2.

SELECT STAFF.STAFFNO, COUNT(STAFF.STAFFNO) AS NumberOfRent, RANK() OVER 
    (ORDER BY COUNT(STAFF.STAFFNO) DESC) AS Rank
FROM STAFF
    JOIN PROPERTYFORRENT
        ON STAFF.STAFFNO = PROPERTYFORRENT.STAFFNO
GROUP BY STAFF.STAFFNO
ORDER BY NUMBEROFRENT DESC;

Q3
SELECT STAFF.STAFFNO, FNAME, LNAME
FROM STAFF
    JOIN PROPERTYFORRENT
        ON STAFF.STAFFNO = PROPERTYFORRENT.STAFFNO
    JOIN VIEWING
        ON PROPERTYFORRENT.PROPERTYNO = VIEWING.PROPERTYNO
WHERE VIEWING.VIEWDATE BETWEEN '01-MAY-13' AND '31-MAY-13'
GROUP BY STAFF.STAFFNO, FNAME, LNAME
ORDER BY STAFF.FNAME DESC;

Q4. 


SELECT CUSTOMER.C_FIRST, C_LAST, ITEM.ITEM_DESC, INVENTORY.INV_PRICE

FROM ITEM
    JOIN INVENTORY
        ON INVENTORY.ITEM_ID = ITEM.ITEM_ID
    JOIN ORDER_LINE 
        ON ORDER_LINE.INV_ID = INVENTORY.INV_ID
    JOIN ORDERS
        ON ORDER_LINE.O_ID = ORDERS.O_ID
    JOIN CUSTOMER
        ON ORDERS.C_ID = CUSTOMER.C_ID
WHERE ORDERS.O_METHPMT = 'CC';



Q5

